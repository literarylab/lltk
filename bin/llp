#!/usr/bin/env python

#import llp
import sys
args=sys.argv
if len(sys.argv)<2: exit()


if sys.argv[1]=='download':
    if len(sys.argv)>2 and sys.argv[2]:
        import llp
        llp.download(sys.argv[2])

elif sys.argv[1]=='list':
    import llp
    manifest=llp.corpus.load_manifest()
    corpus_names=sorted(list(set(manifest.keys())))
    for cname in corpus_names:
        print('>>',cname,'\n'+manifest.get(cname,{}).get('desc','').strip()+'\n')

elif sys.argv[1]=='newcorpus':
    from llp.corpus import start_new_corpus_interactive
    start_new_corpus_interactive()

elif len(args)>2:
    import llp
    cname=args[2]
    fname=args[1]

    xargs=list(args[3:])
    kwargs={}

    if fname=='save_metadata':
        import multiprocessing as mp
        kwargs['slingshot']=mp.cpu_count() #int(mp.cpu_count()/2)

    C=llp.load(cname)
    f=getattr(C,fname)
    f(*xargs,**kwargs)
